### Git

–µ—Å–ª–∏ —Ç–µ–±–µ –Ω—É–∂–Ω–æ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Ç–∏–ª–∏—Ç—É:

```bash
git count-objects -vH

```

–ü–æ–∫–∞–∑–∞—Ç–µ–ª—å size-pack –ø–æ–∫–∞–∂–µ—Ç —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ Git.

–∫–∞–∫ –Ω–∞–π—Ç–∏ –∏ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ç—è–∂—ë–ª—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ Git

–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É size –∏ size-pack
size ‚Äî —ç—Ç–æ –Ω–µ–¥–∞–≤–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–∫–∞ –Ω–µ —É–ø–∞–∫–æ–≤–∞–Ω—ã Git (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ –∫–æ–º–º–∏—Ç–∞, –Ω–æ –¥–æ git gc).

size-pack ‚Äî —ç—Ç–æ —É–ø–∞–∫–æ–≤–∞–Ω–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, –≤–∫–ª—é—á–∞—è –≤—Å–µ —Å—Ç–∞—Ä—ã–µ –∫–æ–º–º–∏—Ç—ã, —Ñ–∞–π–ª—ã, –≤–µ—Ç–∫–∏ –∏ —Ç.–¥.

‚ùì–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è?

üß∞ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: –ö–∞–∫ –Ω–∞–π—Ç–∏ —Å–∞–º—ã–µ —Ç—è–∂—ë–ª—ã–µ —Ñ–∞–π–ª—ã –≤ –∏—Å—Ç–æ—Ä–∏–∏ Git
üîß –°–ø–æ—Å–æ–± 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å git rev-list + git ls-tree (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Git)

```bash
git rev-list --objects --all | \
  git cat-file --batch-check='%(objecttype) %(objectname) %(objectsize) %(rest)' | \
  grep '^blob' | \
  sort -k3 -n -r | \
  head -n 20 | \
  awk '{print $3, $4}' | numfmt --to=iec
```

üëâ –≠—Ç–æ –≤—ã–≤–µ–¥–µ—Ç 20 —Å–∞–º—ã—Ö —Ç—è–∂—ë–ª—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è, —Å –∏—Ö —Ä–∞–∑–º–µ—Ä–æ–º.

‚úÖ –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ: --strip-blobs-bigger-than

```bash
java -jar bfg.jar --strip-blobs-bigger-than 1M
```

üîß –≠—Ç–æ —É–¥–∞–ª–∏—Ç —Ç–æ–ª—å–∫–æ —Ç–µ –≤–µ—Ä—Å–∏–∏ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –∫–æ–≥–¥–∞-–ª–∏–±–æ –±—ã–ª–∏ –±–æ–ª—å—à–µ 1 –º–µ–≥–∞–±–∞–π—Ç–∞, –∞ –Ω–æ–≤—ã–µ –≤–µ—Ä—Å–∏–∏ (200–ö–± –∏ —Ç.–¥.) –æ—Å—Ç–∞–Ω—É—Ç—Å—è.

üîÅ –ü–æ–ª–Ω—ã–π –ø–æ—à–∞–≥–æ–≤—ã–π –ø–ª–∞–Ω:
–°–∫–ª–æ–Ω–∏—Ä—É–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –≤ –∑–µ—Ä–∫–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ (–Ω–µ –≤ –æ–±—ã—á–Ω–æ–º):

–ó–∞–ø—É—Å—Ç–∏ –æ—á–∏—Å—Ç–∫—É –±–æ–ª—å—à–∏—Ö –≤–µ—Ä—Å–∏–π (–æ—Å—Ç–∞–≤–∏—Ç –ª—ë–≥–∫–∏–µ!):

```bash
java -jar bfg.jar --strip-blobs-bigger-than 1M
```

–û—á–∏—Å—Ç–∏ –æ—Å—Ç–∞—Ç–∫–∏:

```bash
git reflog expire --expire=now --all
git gc --prune=now --aggressive
```

–ó–∞–ø—É—à—å –æ–±—Ä–∞—Ç–Ω–æ —Å –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å—é –∏—Å—Ç–æ—Ä–∏–∏:

```bash
git push --force
```

‚úÖ –ù–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –µ—Å–ª–∏:
–¢—ã –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –∏ —Ä–∞–±–æ—Ç–∞–µ—à—å —Å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º –ª–æ–∫–∞–ª—å–Ω–æ.

–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–µ –∫–ª–æ–Ω–∏—Ä—É–µ—Ç—Å—è —á–∞—Å—Ç–æ –∏ —Ç–µ–±–µ –Ω–µ –≤–∞–∂–Ω–æ, —á—Ç–æ .git –≤–µ—Å–∏—Ç 200 –ú–ë.

–¢—ã –Ω–µ –ø–ª–∞–Ω–∏—Ä—É–µ—à—å —Ä–∞–∑–º–µ—â–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –Ω–∞ GitHub Pages, Vercel, Netlify –∏ —Ç.–ø. —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ –Ω–∞ —Ä–∞–∑–º–µ—Ä.

| –ü—Ä–æ–±–ª–µ–º–∞                              | –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ                                                                               |
| ------------------------------------- | ---------------------------------------------------------------------------------------------- |
| üîÑ **–î–æ–ª–≥–æ–µ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**            | –õ—é–±–æ–π, –∫—Ç–æ –∫–ª–æ–Ω–∏—Ä—É–µ—Ç —Ç–≤–æ–π –ø—Ä–æ–µ–∫—Ç, —Ç—è–Ω–µ—Ç –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é, –≤–∫–ª—é—á–∞—è –≥–∏–≥–∞–±–∞–π—Ç—ã –º—É—Å–æ—Ä–∞.                 |
| üì¶ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è GitHub (–∏–ª–∏ CI/CD)** | GitHub **–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç push –¥–æ 100 MB –Ω–∞ —Ñ–∞–π–ª** –∏ 1 GB –Ω–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–≤ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–∏).    |
| üö´ **Deploy –Ω–∞ —Ö–æ—Å—Ç–∏–Ω–≥–∏**             | Vercel, Netlify –∏ –¥—Ä—É–≥–∏–µ –º–æ–≥—É—Ç **–æ—Ç–∫–ª–æ–Ω–∏—Ç—å –¥–µ–ø–ª–æ–π** –ø—Ä–∏ –±–æ–ª—å—à–æ–º —Ä–∞–∑–º–µ—Ä–µ `.git`.                |
| üß† **–°–ª–æ–∂–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è**                | –¢—Ä—É–¥–Ω–µ–µ –ø–æ–Ω—è—Ç—å, –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –∫–æ–≥–¥–∞ –ø–æ—è–≤–∏–ª–∏—Å—å, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ –¥—É–±–ª–∏—Ä—É—é—Ç—Å—è –ø–æ –∏–º–µ–Ω–∏. |
| üì§ **–î–æ–ª–≥–∏–π `git push`/`pull`**       | –ü—Ä–∏ –∫–∞–∂–¥–æ–º –ø—É—à–µ/pull –≤—Å—ë —Ç–∞—â–∏—Ç—Å—è, –æ—Å–æ–±–µ–Ω–Ω–æ –Ω–∞ –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∫–∞–Ω–∞–ª–∞—Ö —Å–≤—è–∑–∏.                         |

üìå –í—ã–≤–æ–¥:
–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –¥–µ—Ä–∂–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —á–∏—Å—Ç—ã–º, –∫–æ–º–ø–∞–∫—Ç–Ω—ã–º –∏ –±—ã—Å—Ç—Ä—ã–º ‚Äî —É–¥–∞–ª–∏—Ç—å —Ç—è–∂—ë–ª—ã–µ —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–æ–∏—Ç.

–ï—Å–ª–∏ —ç—Ç–æ —Ç–≤–æ–π –ª–∏—á–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –∏ —Ç—ã –Ω–µ —á—É–≤—Å—Ç–≤—É–µ—à—å –ø—Ä–æ–±–ª–µ–º ‚Äî –º–æ–∂–µ—à—å –æ—Ç–ª–æ–∂–∏—Ç—å –æ—á–∏—Å—Ç–∫—É –¥–æ —Å–ª–µ–¥—É—é—â–µ–π –≤–∞–∂–Ω–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏.

üö´ –ü–æ—á–µ–º—É Vercel –º–æ–∂–µ—Ç –Ω–µ –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–æ–µ–∫—Ç:
Vercel —Ç—è–Ω–µ—Ç –≤–µ—Å—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏–∑ GitHub ‚Äî –≤–∫–ª—é—á–∞—è .git.

–ï—Å–ª–∏ .git –≤–µ—Å–∏—Ç 200+ MB (—É —Ç–µ–±—è —É–∂–µ 201.50 MiB), Vercel:

–º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–Ω—É—Ç—å –Ω–∞ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏,

–∏–ª–∏ –≤–æ–æ–±—â–µ –æ—Ç–∫–ª–æ–Ω–∏—Ç—å —Å–±–æ—Ä–∫—É —Å –æ—à–∏–±–∫–æ–π fatal: pack exceeds limit.

–î–∞–∂–µ –µ—Å–ª–∏ –≤—Å—ë —Å–æ–±–µ—Ä—ë—Ç—Å—è ‚Äî —Å–±–æ—Ä–∫–∏ —Å—Ç–∞–Ω—É—Ç –º–µ–¥–ª–µ–Ω–Ω—ã–º–∏ –∏ –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω—ã–º–∏.

‚úÖ –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, —á—Ç–æ–±—ã –≤—Å—ë —Ä–∞–±–æ—Ç–∞–ª–æ –∏–¥–µ–∞–ª—å–Ω–æ:
üì¶ –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –≤–µ—Ä—Å–∏–∏ —Ç—è–∂—ë–ª—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∏–∑ Git –∏—Å—Ç–æ—Ä–∏–∏ (–º—ã —É–∂–µ –ø–æ—á—Ç–∏ –≤—Å—ë —Ä–∞–∑–æ–±—Ä–∞–ª–∏).

üöÄ –ü–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏:

.git —Å—Ç–∞–Ω–µ—Ç –º–µ–Ω—å—à–µ 10‚Äì20 –ú–ë,

–ø—Ä–æ–µ–∫—Ç –±—É–¥–µ—Ç –ª–µ–≥–∫–æ –¥–µ–ø–ª–æ–∏—Ç—å—Å—è –Ω–∞ Vercel.
